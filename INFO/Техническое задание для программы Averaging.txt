Техническое задание для программы "Калькулятор усреднения (Безубыточная точка)"
1. Цель программы:
Разработать программу для инвесторов, позволяющую рассчитать среднюю цену входа (безубыточную точку) после нескольких покупок одного актива (акции, криптовалюты) по разным ценам, а также прогнозировать цену следующей докупки при заданной просадке.

2. Основные функции и логика:

Функция 1: Расчет текущей средней цены (безубыточной точки)

Входные данные: Список совершенных покупок. Каждая покупка описывается двумя параметрами:

investment (X): Сумма вложенных денег.

price (Y): Цена актива на момент покупки.

Математическая логика:

Для каждой покупки рассчитывается количество купленных активов: quantity = investment / price.

Суммируются все вложенные средства: total_investment = sum(X1, X2, X3, ...).

Суммируются все купленные активы: total_quantity = sum(Z1, Z2, Z3, ...).

Средняя цена (безубыточная точка) рассчитывается по формуле: break_even_price = total_investment / total_quantity.

Выходные данные: Числовое значение break_even_price, которое представляет собой среднюю цену входа по всем покупкам. При достижении этой цены общая позиция становится безубыточной.

Функция 2: Управление списком покупок

Программа должна предоставлять интерфейс (консольный или графический) для:

Добавления покупки: Ввод пользователем investment и price. После добавления пересчитывается и отображается текущая break_even_price.

Просмотра списка покупок: Отображение таблицы с данными о всех покупках (№, Сумма вложений, Цена покупки, Количество активов).

Удаления покупки (опционально, но желательно для исправления ошибок).

Функция 3: Расчет цены следующей докупки

Входные данные:

last_price (Y_last): Цена последней добавленной в список покупки.

drawdown_percent (P): Процент просадки от последней цены, при которой планируется следующая покупка. Значение по умолчанию: 15%.

Математическая логика:

Цена следующей докупки рассчитывается по формуле: next_purchase_price = last_price * (1 - drawdown_percent / 100).

Выходные данные: Числовое значение next_purchase_price. Эта цена должна отображаться в интерфейсе и автоматически обновляться при добавлении новой покупки или изменении процента просадки.

3. Требования к интерфейсу (UI):

Программа может быть реализована как консольное приложение (для начала) или с простым графическим интерфейсом (например, на Tkinter).

Элементы интерфейса должны включать:

Секция "История покупок":

Таблица для отображения покупок.

Поля ввода "Сумма вложений" и "Цена покупки" и кнопка "Добавить покупку".

Секция "Текущие результаты":

Поле для отображения Общей вложенной суммы (total_investment).

Поле для отображения Общего количества активов (total_quantity).

Поле для отображения Средней цены (Безубыточной точки) (break_even_price).

Секция "Планирование следующей покупки":

Поле для отображения Цены последней покупки (last_price).

Поле для ввода/изменения Процента просадки (drawdown_percent).

Поле для отображения Цены следующей покупки (next_purchase_price).

4. Логика работы программы (Пользовательский сценарий):

Пользователь запускает программу.

Он вводит данные о первой покупке: сумму и цену. Нажимает "Добавить".

Программа рассчитывает и отображает:

Среднюю цену (которая будет равна цене первой покупки).

Цену для следующей покупки (например, last_price * 0.85).

Цена актива падает. Пользователь совершает вторую покупку. Вводит новые данные.

Программа пересчитывает среднюю цену (она станет ниже, между первой и второй ценой).

Теперь "Цена последней покупки" обновилась на цену второй покупки, и соответственно пересчиталась "Цена следующей покупки".

Пользователь может в любой момент изменить "Процент просадки", чтобы посмотреть, при какой цене сработает следующая гипотетическая покупка.

5. Дополнительные соображения для разработчика (Cursor Agent):

Обработка ошибок: Программа должна быть устойчива к некорректному вводу (например, ввод текста вместо чисел, деление на ноль).

Хранение данных: Для простоты данные можно хранить в оперативной памяти (в списке или словаре) на время работы сессии. В будущем можно добавить сохранение в файл.

Форматирование вывода: Цены и суммы рекомендуется выводить в удобочитаемом формате (например, с двумя знаками после запятой).

Архитектура: Рекомендуется разделить логику вычислений (отдельные функции для calculate_break_even, calculate_next_purchase) и код интерфейса для удобства поддержки и тестирования.